# Code-Vulnerability-about-Timing-Attack
Detection of Code Vulnerability about Timing Attack

## Preparation
### Environment configuration


### Sample code generation
- The templates are in folder [templates](codegenerate/templates) (string comparison) and [templates2](codegenerate/templates2) (bytes comparison)
- Run scripts [createfiles.py](codegenerate/createfiles.py) with these commands:
```bash
cd codegenerate
python createfiles.py
```
- The generated codes are saved in [codes](codegenerate/codes)

## Experiments
### 1. Symbolic Execution Experiment

[angrtrace2.py](angrtrace2.py) is able to print the path that symbolic execution goes through and draw the CFG.
The output for [angrtrace2.py](angrtrace2.py) is shown below:
```bash
1
['0x401080', '0x500000', '0x4011dd', '0x401169', '0x4011bd', '0x401060', '0x500008', '0x4011cf', '0x40118e', '0x4011b9', '0x401060', '0x500008', '0x4011cf', '0x40118e', '0x4011b2', '0x401060', '0x500008', '0x4011cf', '0x40118e', '0x4011b2', '0x401060', '0x500008', '0x4011cf', '0x4011d4', '0x40121b', '0x401070', '0x500010', '0x401231', '0x601050']
Number of blocks passed: 29
```
It indicates that there are only one path, for `str_a = "aaa"`, `str_b = "acb"` have determined. 
The addresses of each code block passed when symbolic executed this are shown in the list, with order.
(Form the [CFG](cfg_1.png) shows the code contained in these addresses and what part of the program they are in). 
There are totally 29 blocks passed in this process.

Use the same principle, when symbolize str_a and str_b, as shown in [angrtrace1.py](angrtrace2.py)
```python
str_a_length = 10
str_b_length = 10
str_a = claripy.BVS("str_a", 8 * str_a_length)  # Each character is 8 bits
str_b = claripy.BVS("str_b", 8 * str_b_length)
```
And let the length of `str_a` be constant, the length of `str_b` is between 0 and 10

The number of blocks passed is shown in `logs/`, if different inputs make all pass the same number of code blocks, then it is time constant.

The result shows that [compare1.cpp](codegenerate/codes/compare1.cpp), [compare6.cpp](codegenerate/codes/compare6.cpp) and [compare11.cpp](codegenerate/codes/compare11.cpp) are time constant. 
This is consistent with the hypothesis. Because they have no earlier break inside the loop.
